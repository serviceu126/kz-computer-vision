from dataclasses import dataclass
from typing import Dict, Optional


@dataclass
class BedInfo:
    sku: str       # полный код из 1С
    title: str     # что показываем крупно (bed_title)
    details: str   # строка под заголовком (bed_details)


BEDS: Dict[str, BedInfo] = {}


def _add(sku: str, model_code: str, width_code: str, color_code: str) -> None:
    """
    sku        – полный код из 1С, например 'MM.Кровать.001-12-VelutaLux.07'
    model_code – '001-12', '003-16' и т.п.
    width_code – '12', '14', '16' (десятки сантиметров)
    color_code – '07', '20', '23', '26', '32'
    """
    # ширину считаем в сантиметрах: 12 -> 120, 14 -> 140, 16 -> 160
    try:
        width_cm = int(width_code) * 10
    except ValueError:
        width_cm = 0

    title = f"Кровать VelutaLux {model_code}"
    if width_cm > 0:
        details = f"Модель {model_code} | Ширина {width_cm} см | Цвет {color_code}"
    else:
        details = f"Модель {model_code} | Цвет {color_code}"

    BEDS[sku] = BedInfo(sku=sku, title=title, details=details)


# ── 001-12 ────────────────────────────────────────────────────────────────
_add("MM.Кровать.001-12-VelutaLux.07", "001-12", "12", "07")
_add("MM.Кровать.001-12-VelutaLux.20", "001-12", "12", "20")
_add("MM.Кровать.001-12-VelutaLux.23", "001-12", "12", "23")
_add("MM.Кровать.001-12-VelutaLux.26", "001-12", "12", "26")
_add("MM.Кровать.001-12-VelutaLux.32", "001-12", "12", "32")

# ── 001-14 ────────────────────────────────────────────────────────────────
_add("MM.Кровать.001-14-VelutaLux.07", "001-14", "14", "07")
_add("MM.Кровать.001-14-VelutaLux.20", "001-14", "14", "20")
_add("MM.Кровать.001-14-VelutaLux.23", "001-14", "14", "23")
_add("MM.Кровать.001-14-VelutaLux.26", "001-14", "14", "26")
_add("MM.Кровать.001-14-VelutaLux.32", "001-14", "14", "32")

# ── 001-16 ────────────────────────────────────────────────────────────────
_add("MM.Кровать.001-16-VelutaLux.07", "001-16", "16", "07")
_add("MM.Кровать.001-16-VelutaLux.20", "001-16", "16", "20")
_add("MM.Кровать.001-16-VelutaLux.23", "001-16", "16", "23")
_add("MM.Кровать.001-16-VelutaLux.26", "001-16", "16", "26")
_add("MM.Кровать.001-16-VelutaLux.32", "001-16", "16", "32")

# ── 003-12 ────────────────────────────────────────────────────────────────
_add("MM.Кровать.003-12-VelutaLux.07", "003-12", "12", "07")
_add("MM.Кровать.003-12-VelutaLux.32", "003-12", "12", "32")
# если у 003-12 есть ещё цвета (.20/.23/.26) — допиши их по образцу

# ── 003-14 ────────────────────────────────────────────────────────────────
_add("MM.Кровать.003-14-VelutaLux.07", "003-14", "14", "07")
_add("MM.Кровать.003-14-VelutaLux.20", "003-14", "14", "20")
_add("MM.Кровать.003-14-VelutaLux.23", "003-14", "14", "23")
_add("MM.Кровать.003-14-VelutaLux.26", "003-14", "14", "26")
_add("MM.Кровать.003-14-VelutaLux.32", "003-14", "14", "32")

# ── 003-16 ────────────────────────────────────────────────────────────────
_add("MM.Кровать.003-16-VelutaLux.07", "003-16", "16", "07")
_add("MM.Кровать.003-16-VelutaLux.20", "003-16", "16", "20")
_add("MM.Кровать.003-16-VelutaLux.23", "003-16", "16", "23")
_add("MM.Кровать.003-16-VelutaLux.26", "003-16", "16", "26")
_add("MM.Кровать.003-16-VelutaLux.32", "003-16", "16", "32")


def get_bed_info(sku: str) -> Optional[BedInfo]:
    """
    Вернуть информацию по кровати по её полному коду из 1С.
    Если такой записи нет в каталоге — вернуть None.
    """
    return BEDS.get(sku)
